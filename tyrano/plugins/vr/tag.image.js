tyrano.plugin.kag.tag.image_new={vital:["id","storage"],pm:{id:"",folder:"",storage:""},start:function(pm){var that=this;var j_assets=$("#vr_assets");if(pm.folder!="")folder=pm.folder;else folder="image";var storage_url="./data/"+folder+"/"+pm.storage;$.vr.exists(storage_url);var j_img=$("<img />");j_img.attr("id",pm.id);j_img.attr("src",storage_url).load(function(){j_img.attr("data-width",j_img.get(0).width);j_img.attr("data-height",j_img.get(0).height);j_assets.append(j_img);TYRANO.kag.ftag.nextOrder()})}};
tyrano.plugin.kag.tag.image={vital:["id"],pm:{id:"",name:"",layer:"space",x:"0",y:"0",z:"0",xr:"0",yr:"0",zr:"0",time:"1000",wait:"true",scale:"1"},start:function(pm){var that=this;var el_img=document.createElement("a-image");$.vr.checkAsset(pm.id);el_img.setAttribute("src","#"+pm.id);var data_width=$("#vr_assets").find("#"+pm.id).attr("data-width");var data_height=$("#vr_assets").find("#"+pm.id).attr("data-height");data_width=data_width/100*parseFloat(pm.scale);data_height=data_height/100*parseFloat(pm.scale);
el_img.setAttribute("material","alphaTest: 0.01");el_img.setAttribute("width",$.cutFloat(data_width,3));el_img.setAttribute("height",$.cutFloat(data_height,3));el_img.setAttribute("position",{x:pm.x,y:pm.y,z:pm.z});el_img.setAttribute("rotation",{x:pm.xr,y:pm.yr,z:pm.zr});el_img.setAttribute("opacity",0);if(pm.name=="")pm.name=pm.id;$.vr.setName(el_img,pm.name);if(pm.layer=="space")document.querySelector("#vr_scene").appendChild(el_img);else document.querySelector("#vr_camera").appendChild(el_img);
$.vr.fadeIn(el_img,{time:pm.time},function(e){if(pm.wait=="true")TYRANO.kag.ftag.nextOrder()});if(pm.wait=="false")TYRANO.kag.ftag.nextOrder()}};
tyrano.plugin.kag.tag.free={vital:["name"],pm:{name:"",time:"1000",wait:"true"},start:function(pm){var that=this;var num=0;var cnt_fade=0;if(!$("#vr ."+pm.name).size()){TYRANO.kag.ftag.nextOrder();return}if($("#vr ."+pm.name).hasClass("3d_model")){$("#vr ."+pm.name).remove();TYRANO.kag.ftag.nextOrder();return}$("#vr ."+pm.name).each(function(key,el_obj){num++;$.vr.fadeOut(el_obj,{time:pm.time},function(){cnt_fade++;$(el_obj).remove();if(num==cnt_fade)if(pm.wait=="true")TYRANO.kag.ftag.nextOrder()})});
if(pm.wait=="false")TYRANO.kag.ftag.nextOrder()}};tyrano.plugin.kag.tag.freeall={vital:[],pm:{layer:"all"},start:function(pm){if(pm.layer=="all"){$("#vr_scene").empty();$("#vr_camera").empty()}else if(pm.layer=="space")$("#vr_scene").empty();else if(pm.layer=="eye")$("#vr_camera").empty();TYRANO.kag.ftag.nextOrder()}};
tyrano.plugin.kag.tag.image360={vital:["id"],pm:{id:"",name:"",time:"1000",wait:"true",xr:"0",yr:"0",zr:"0"},start:function(pm){$("a-sky").remove();var that=this;var el_img=document.createElement("a-sky");el_img.setAttribute("src","#"+pm.id);el_img.setAttribute("material","");el_img.setAttribute("geometry","");el_img.setAttribute("scale","");el_img.setAttribute("rotation",{x:pm.xr,y:pm.yr,z:pm.zr});if(pm.name=="")pm.name=pm.id;$.vr.setName(el_img,pm.name);document.querySelector("#vr_scene").appendChild(el_img);
$.vr.fadeIn(el_img,{time:pm.time},function(e){if(pm.wait=="true")TYRANO.kag.ftag.nextOrder()});if(pm.wait=="false")TYRANO.kag.ftag.nextOrder()}};
